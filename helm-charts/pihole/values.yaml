replicaCount: 1

image:
  repository: pihole/pihole
  tag: latest
  pullPolicy: IfNotPresent

timezone: "Europe/London"
adminPassword: "correct horse battery staple"

hostNetwork: false

extraEnv:
  # 1. This tells Pi-hole to accept ANY hostname (Safe because Ingress filters it first)
  FTLCONF_webserver_api_allowedHosts: "*"
  # 2. Automatically trust the entire Kubernetes pod and service networks
  FTLCONF_webserver_api_trustedProxies: "10.0.0.0/8,172.16.0.0/12,192.168.0.0/16"
  # 3. Use the standard Pi-hole hostname
  VIRTUAL_HOST: "pi.hole"

persistence:
  storageClass: "local-path"
  pihole:
    size: 2Gi
  dnsmasq:
    size: 1Gi

service:
  dnsUdpPort: 30053
  dnsTcpPort: 30054
  webPort: 80 
  httpsPort: 443

ingress:
  enabled: true
  className: nginx
  annotations:
    # Forces any root request to go straight to /admin
    nginx.ingress.kubernetes.io/app-root: /admin
    # Important for v6 API stability
    nginx.ingress.kubernetes.io/proxy-body-size: "0"
    kubernetes.io/ingress.class: nginx
    # This is the "proper" way: tell Nginx to pass the hostname through to the pod
    nginx.ingress.kubernetes.io/upstream-vhost: "pi.hole"
  hosts:
    - host: pi.hole
      paths:
        - path: /
          pathType: Prefix
  tls:
    - secretName: pihole-tls-secret
      hosts:
        - pi.hole